  <?php

/**
 * @file
 * Rules tests.
 */

class PublicationDateTestCase extends DrupalWebTestCase {
  protected $privileged_user;
  static function getInfo() {
    return array(
      'name' => 'Published date setting test',
      'description' => 'Test to see the published_at values are working',
      'group' => 'Publication Date',
    );
  }

  function setUp() {
    parent::setUp('publication_date');
    $this->privileged_user = $this->drupalCreateUser(array(
      'create page content',
      'administer nodes',
      ));
    $this->drupalLogin($this->privileged_user);
  }


  /**
   * Test automatic saving of variables.
   */
  function testActionSaving() {

    // Create node to edit.    
    $node = $this->drupalCreateNode(array('status' => 0));
    $unpublished_node = node_load($node->nid);
    $this->assertTrue(empty($unpublished_node->published_at),'Published date is initially empty');

    $unpublished_node->status =1;
    node_save($unpublished_node);
    $published_node = node_load($node->nid);
    $this->assertTrue(is_numeric($published_node->published_at),'Published date is integer/numberic once published');


    $published_node->status =0;
    node_save($published_node);
    $unpublished_node = node_load($node->nid);
    $this->assertTrue(empty($node->published_at),'Published date is empty once unpublished');

  }

}





